
\section{Introduction}
Natural selection is the key force in evolution, and a mechanism by
which populations can adapt to external `selection'
constraints. Examples of adaptation abound in the natural world,
including for example, classic examples like lactose tolerance in
Northern Europeans~\cite{bersaglieri2004genetic}, human adaptation to high
altitudes~\cite{yi2010sequencing,simonson2010genetic}, but also drug 
resistance in
pests~\cite{daborn2001ddt}, HIV~\cite{Feder2016More},
cancer~\cite{gottesman2002mechanisms,zahreddine2013mechanisms},
malarial parasite~\cite{ariey2014molecular,nair2007recurrent}, and
other antibiotic resistance~\cite{spellberg2008epidemic}. In each of
these examples, understanding the genetic basis of adaptation can
provide actionable information, underscoring the importance of the
problem.

Modern experimental evolution refers to the study of the evolutionary
processes of a model organism at genomic level in a controlled
\cite{hegreness2006equivalence,lang2013pervasive,orozco2012adaptation,
  lang2011genetic,barrick2009genome,bollback2007clonal,oz2014strength}
or natural
\cite{maldarelli2013hiv,reid2011new,denef2012situ,winters2012development,
  daniels2013genetic,barrett2008natural,bergland2014genomic}
environment. Recent advances in whole genome sequencing have enabled
us to sequence populations at a reasonable cost even when the genomes
are large. Perhaps more important for experimental evolution studies,
we can now obtain and sequence \emph{longitudinal time-series data},
sampling populations over a period of time, and investigating the
dynamics of evolution at molecular level.  Although constraints such
as small population sizes, limited timescales, and oversimplified
laboratory environments limit the interpretation of EE results, these
studies are increasingly being used to test hypotheses regarding
mutation rate, inbreeding, environmental variability, sexual selection
\& conflict, kin selection and cooperation, life history and sex
allocation, sexual reproduction and mating systems, behavior and
cognition, and host-–parasite
interactions~\cite{kawecki2012experimental}. In many cases, they
provide more accurate inferences than static data analysis
\cite{boyko2008assessing,desai2008polymorphism,sawyer1992population}. Dynamic
data is also being used to estimate model parameters including
population
size~\cite{williamson1999using,wang2001pseudo,pollak1983new,waples1989generalized,
  Terhorst2015Multi}, strength of
selection~\cite{mathieson2013estimating,illingworth2011distinguishing,Terhorst2015Multi,
  bollback2008estimation,illingworth2012quantifying,malaspinas2012estimating,
  Steinrücken2014a}, allele age~\cite{malaspinas2012estimating}
recombination rate~\cite{Terhorst2015Multi}, mutation
rate~\cite{Barrick2013Genome, Terhorst2015Multi}, quantitative trait
loci~\cite{baldwin2014power} and for tests of neutrality
hypotheses~\cite{feder2014Identifying,Terhorst2015Multi,burke2010genome,bergland2014genomic}.


While different types of EE experiments have been
proposed~\cite{Barrick2013Genome,schlotterer2015combining} our focus
here is the adaptive evolution of multi-cellular sexual organisms. For
simplicity, we assume continuous culture, fixed population size, and
for the most part, positive single locus selection (only one favored
mutation). This regime has been extensively applied, often with
\emph{Drosophila} as the model organism of choice. It has been used to
identify adaptive genes in longevity and aging
~\cite{burke2010genome,remolina2012genomic} (600 generations),
courtship song~\cite{turner2011population} (100 generations), hypoxia
tolerance~\cite{zhou2011experimental} (200 generations), adaptation to
new temperatures~\cite{orozco2012adaptation,tobler2014massive} (59
generations), egg size~\cite{jha2015whole} (40 generations), C virus
resistance~\cite{martins2014host} (20 generations), and
dark-fly~\cite{izutsu2015dynamics} (49 generations) experiments. Our
methods can be generalized to other sexual populations, but are
separate from the analysis of asexual populations. In sexual
populations, the mutation responding to the selection constraint is
linked to neighboring mutations, but the linkage decays rapidly due to
recombination. Together, this provides a strengthened signal around
the favored mutation. Therefore, methods for identifying genomic
regions under selection in sexual populations often focus on analyzing
genomic regions, rather than single sites.

The task of identification of a selection event in natural or
experimental evolution can be addressed at different levels of
specificity. At the coarsest level, identification could simply refer
to deciding whether some genomic region is under selection or not.  In
the following, we refer to this task as \emph{detection}. In contrast,
the task of \emph{site-identification} corresponds to the process of
finding the favored mutation/allele itself. Finally, \emph{estimation
  of model parameters} such as strength of selection and over-dominance
at the site can provide a comprehensive description of the selection
process.

A wide range of computational methods~\cite{vitti2013detecting} have
been developed to detect regions under positive selection. A majority
of the existing methods focus on static data analysis--analyzing a
single sample of the population at a specific time, either during the
sweep, or subsequent to fixation of the favored allele. For instance,
reduction in genetic
diversity~\cite{tajima1989statistical,fay2000hitchhiking,ronen2013learning}
in allele-frequency data, prevalence of long
haplotypes~\cite{sabeti2006positive,vitti2013detecting} in haplotype
(phased) data, population
differentiation~\cite{holsinger2009genetics,burke2010genome} in
multiple-population data and others. Many existing methods use the
Site Frequency Spectrum (SFS, see Suppl.~Fig.~\ref{fig:sfs}) to
identify departure from neutrality. Classical examples including
Tajima's \emph{D}~\cite{tajima1989statistical}, Fay and Wu's
\emph{H}~\cite{fay2000hitchhiking}, Composite Likelihood
Ratio~\cite{nielsen2005genomic}, were all shown to be weighted linear
combination of the SFS values~\cite{achaz2009frequency}. However, the
SFS of a sample under selection changes with time since onset of
selection, the frequency of the favored allele at the onset of
selection, (high initial frequency of the favored allele is also
referred to as standing variation) and other parameters. Not
surprisingly, the power of these SFS based tests depends upon
different selection parameters. This insight can be exploited to learn
the right weights for each regime and improve detection
accuracy~\cite{ronen2013learning}.

While successful, these methods are prone to both, false
negatives~\cite{messer2013population}, as also false-discoveries due
to confounding factors such as demography, including bottleneck and
population expansions, and ascertainment bias ~\cite{ptak2002evidence,
  ramos2002statistical,akey2009constructing,
  nielsen2003correcting,messer2013population}. Nevertheless, SFS based
tests are simple and inexpensive and continue to be used, often in
combination with other
tests~\cite{akey2009constructing,vitti2013detecting}. One of the
contributions of this paper is the extension of SFS based methods to
analyze time-series data, and the identification of selection regimes
where these methods perform well.

Relative to the analysis of static samples, fewer tests-of-selection
for dynamic time-series data have been proposed. Often, existing tests
for static data are adopted for dynamic data with two time-points. Zhu
et al.~\cite{zhou2011experimental} used the ratio of the estimated
population size of case and control populations to compute test
statistic for each genomic region. Burke \emph{et
  al.}~\cite{burke2010genome} applied Fisher exact test to the last
observation of data on case and control populations.  Orozco-Terwengel
\emph{et al.}~\cite{orozco2012adaptation} used the
Cochran-Mantel-Haenszel (CMH) test~\cite{agresti2011categorical} to
detect SNPs whose read counts change consistently across all
replicates of two time-point data.  Turner \emph{et
  al.}~\cite{turner2011population} proposed the diffStat statistic to
test whether the change in allele frequencies of two population
deviates from the distribution of change in allele frequencies of two
drifting populations.  Bergland \emph{et
  al.}~\cite{bergland2014genomic} applied $F_{st}$ to populations
throughout time to signify their differentiation from ancestral (two
time-point data) as well as geographically different populations. Jha
\emph{et al.}~\cite{jha2015whole} computed test statistic of
generalized linear-mixed model directly from read counts.  Bollback et
al.~\cite{bollback2008estimation} provided diffusion approximation to
the continues Wright Fisher Markov process and estimated $s$
numerically and performed standard likelihood ratio test under $\Xc^2$
distribution.

It is only recently that direct tests for analyzing time-series data
have been developed. Using (continuous-time continuous-state) Brownian
motion process, Feder \emph{et al.}~\cite{feder2014Identifying}
proposed the Frequency Increment Test (FIT) for dynamic allele
frequency data. More recently, Song \emph{et
  al.}~\cite{Terhorst2015Multi} proposed empirical Gaussian Process
(GP) likelihood ratio test for single and multiple loci dynamic allele
frequency data. The heavy computational requirements of these methods
makes it difficult to apply them in a whole genome setting.  Topa
\emph{et al.}~\cite{topa2015gaussian} extended GP to analyze
pooled-sequencing read count data A key contribution of our paper is
the development of a direct, and significantly faster method, \comale,
for detecting selection in short-term experimental evolution with
pooled sequencing (read count) data (see
Suppl.~Fig.~\ref{fig:trajectoryReal} for an example).  We show for a
wide range of parameters that \comale\ provides higher power for
detecting selection, is robust to ascertainment bias, estimates model
parameters consistently, and localizes beneficial allele more
accurately compared to the state-of the art methods, while being
orders of magnitude faster.
