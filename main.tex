\documentclass[11pt]{article}
\input{macros_vineet}
\input{macros_arya}
\title{Detecting Selection in Experimental Evolution Experiments}
\author[1]{Arya Iranmehr}
\author[1]{Ali Akbari}
\author[2]{Vineet Bafna}
\affil[1]{\footnotesize Electrical and Computer Engineering, University of California, San Diego, La Jolla, CA 92093, USA.}
\affil[2]{\footnotesize Computer Science \& Engineering, University of California, San Diego, La Jolla, CA 92093, USA}
\date{}
\def\comale{\text{COMALE }}
\usepackage{booktabs}
\begin{document}
\maketitle
\begin{abstract}
Experimental evolution (EE) studies are powerful tools for observing
molecular evolution ``in-action" in wild and controlled environments. This 
paradigm of experiment was infeasible until recently when the whole-genome 
and whole-population was made possible by next-generation sequencing 
technologies. 
However, one of the primary constraints of the EE studies 
is the limited time for the experiment, which primarily depend on the 
organism's 
generation 
time. This constraint impedes adaptation and optimization (evolvability) 
studies, where the population 
can only evolved and re-sequenced in a small number of generations, 
relative to the number of generations required for fixation of adaptive 
allele. 
Although a 
powerful library of tests-of-selection has already been developed, they are 
mainly designed for static data to
to identify adaptation when the sample is taken close enough (before/after) 
to the fixation of adaptive allele.
In this article, we study the problem of identifying selective sweep in 
short-term experimental evolution of sexual organisms and  propose Composite 
Of MArkovian Likelihoods for Experimental evolution (\comale) statistic which 
computes its score by 
averaging 
likelihood ratios of polymorphisms for a genomic region. 
The likelihood of null
(neutral) and 
alternative (selection) hypotheses calculated using the Wright-Fisher Markov 
chain model 
for each variant. Extensive simulation study shows that
\comale\ achieves higher detection power methods on both soft and 
hard sweep simulations for various selection strengths. 
Finally, we apply the \comale\ statistic to the controlled experimental 
evolution of D. melanogaster to detect adaptive genes/alleles under alternating 
cold and hot temperatures.
\end{abstract}



\section{Introduction}

\paragraph{Experimental Evolution.}
Recent advances of whole genome sequencing has enabled us to sequence 
populations at a reasonable cost, such that one could design experiments
to study different forces of evolution in real-time. Modern experimental 
evolution refers to the study of the evolutionary processes of a model organism 
at genomic level in a 
controlled  
\cite{hegreness2006equivalence,lang2013pervasive,orozco2012adaptation,
	lang2011genetic,barrick2009genome,bollback2007clonal,oz2014strength} 
or natural 
\cite{maldarelli2013hiv,reid2011new,denef2012situ,winters2012development,
	daniels2013genetic,barrett2008natural,bergland2014genomic} environment.
Constraints such as small population sizes, limited 
timescales and oversimplified laboratory
environments limits interpreting experimental evolution results, yet, they can 
be used
been used to test different hypotheses~\cite{kawecki2012experimental}
regarding
mutation rate, 
inbreeding, 
environmental variability,
sexual selection and conflict, 
kin selection and cooperation
life history and sex allocation, 
sexual reproduction and mating systems, 
behavior and cognition, 
host–parasite interactions, 
speciation repeatability of evolution 
and make more accurate inferences 
than static data analysis 
\cite{boyko2008assessing,desai2008polymorphism,sawyer1992population}. In 
addition, dynamic data has been used to estimate model parameters 
including population size
\cite{williamson1999using,wang2001pseudo,pollak1983new,waples1989generalized,
	Terhorst2015Multi}
strength of selection
\cite{mathieson2013estimating,illingworth2011distinguishing,Terhorst2015Multi,
	bollback2008estimation,illingworth2012quantifying,malaspinas2012estimating,
	Steinrücken2014a}, allele age
\cite{malaspinas2012estimating}
recombination rate~\cite{Terhorst2015Multi}, mutation
rate~\cite{Barrick2013Genome, Terhorst2015Multi} and test neutrality hypotheses 
\cite{feder2014Identifying,Terhorst2015Multi,burke2010genome,bergland2014genomic}.

Among different types of evolution experiments 
\cite{Barrick2013Genome,schlotterer2015combining} in 
this 
paper we only focus on adaptive evolution of multicellular sexual organisms 
with 
continues culture, fixed population size, single locus selection (only one 
causal mutation). 
For this setting, D. melanogaster is 
usually the model organism and it has been used to identify adaptive genes in 
longevity and aging ~\cite{burke2010genome,remolina2012genomic} (600 and  
generations respectively),
courtship song \cite{turner2011population} (100 generations),
hypoxia tolerance \cite{zhou2011experimental} (200 generations),
adaptation to new temperatures\cite{orozco2012adaptation,tobler2014massive} (37 
generations),
egg size \cite{jha2015whole} (40 generations),
C virus resistance \cite{martins2014host} (20 generations),
and dark-fly~\cite{izutsu2015dynamics} (49 generations) experiments.

\paragraph{Natural selection.} Natural selection is one of the main forces of 
the evolutionary 
process and 
identifying it at the genomic level is one of the critical problems facing 
humanity.
For example, drug resistance in HIV ~\cite{Feder2016More}, 
cancer~\cite{gottesman2002mechanisms,zahreddine2013mechanisms},
malaria~\cite{ariey2014molecular,nair2007recurrent},
pests~\cite{daborn2001ddt} or antibiotic 
resistance~\cite{spellberg2008epidemic} are instances of genetic adaptations 
that yet to be 
understood at genomic level, which could potentially return us to the 
pre-antibiotic age.
Although, a wide range of computational methods \cite{vitti2013detecting} 
enable us to identify different regimes of genetic adaptations, Messer 
and Petrov 
\cite{messer2013population} argued that ``many, if not most, cases of 
adaptation are yet to be discovered", false-negatives. In addition, current 
methods prone to ``pathelogical false-positives" due to other confounding 
factors such as demography.


\paragraph{Selective sweep.} Selective sweep 
\cite{smith1974hitch,kaplan1989hitchhiking} is the 
model for describing directional single-locus selection, which takes into 
account of associations of the beneficial mutation with its surrounding loci.
In other words, in a selective sweep not only the adaptive locus, but also its 
nearby loci expands to the population.
The extent of genetic loci that are in association with the adaptive allele 
depends on the amount of accumulated recombination events between adaptive 
allele and the rest of genome. 

In the asexual populations, where no 
crossover occurs, the whole genome is perfectly linked to the 
adaptive allele the whole genome ``hitchhikes" with the beneficial mutation in 
the sweep process.
Also, when (beneficial) mutation rate is high, it is possible that more than 
one beneficial allele exist in the population at the same time and ``clonal 
interference" \cite{desai2007beneficial,lang2013pervasive} 
best describes the adaptation process.

On the other hand, in sexual population, the favored mutation is only in 
linkage-disequilibrium (LD) with its nearby polymorphisms. Hence, methods for 
identifying selective 
sweep in sexual populations often analyze  polymorphism data of a population of 
in a genomic region, rather than a single site. 

\paragraph{Identifying Natural Selection.} Adaptation leaves a variety of 
signatures 
in different kinds of genomic data, and methods for identifying natural 
selection are essentially \emph{data-driven}. For instance, reduction in 
genetic 
diversity\cite{tajima1989statistical,fay2000hitchhiking,ronen2013learning} in 
allele-frequency data, 
prevalence of long haplotypes 
	\cite{sabeti2006positive,vitti2013detecting} in haplotype (phased) data, 
	population differentiation \cite{holsinger2009genetics,burke2010genome} in 
	multiple-population	data and rapid increase in allele 
	frequencies \cite{bergland2014genomic} in the dynamic data are different 
	signatures of selective sweep in the polymorphism data.
In this paper, we restrict our attention to the experimental evolution 
experiments with pooled-sequencing, where dynamic allele frequency 
of the population is available. 

The identification of an selection event can be done in 
different levels of detail. At the coarsest level, identification can be done 
by 
determining whether a region 
(e.g. a small region with no or low recombination) on genome is 
under selection. 
In the rest, 
we consider this task to 
be the task of \emph{detection}.
Then, finding the causal 
mutation/allele would be a more elaborate identification of selection, 
henceforth, \emph{locating} selection. 
Finally, estimating model parameters such as strength of selection and 
overdominance at the site fully describes the selective sweep.

\paragraph{Static Data.} Traditionally, given static allele frequency data, 
Site Frequency Spectrum 
(SFS) is computed to perform neutrality tests including Tajima's \emph{D} 
~\cite{tajima1989statistical}, 
Fay and Wu's \emph{H}~\cite{fay2000hitchhiking}, 
Composite Likelihood Ratio~\cite{nielsen2005genomic}, 
SFSelect~\cite{ronen2013learning}, in a genomic 
region\footnote{The extent of genomic region is mainly depend on the  amount 
background linkage in the genome.}. Despite their simplicity and clarity, 
it has been shown that
  SFS-based tests often fail to distinguish demographic changes from 
  adaptation. They 
  are also prone to pathological false-positive/negatives
  due to low linkage of the adaptive allele to its surrounding variation and 
  ascertainment bias ~\cite{ptak2002evidence, 
  ramos2002statistical,akey2009constructing, 
  nielsen2003correcting,messer2013population}. 

SFS (Figure \ref{fig:afs}) shows the distribution of allele 
frequencies in a genomic region.
Historically, SFS of static data has been extensively used to 
``detect" genetic 
adaption and demographic changes in a population. Basically, 
SFS is measure of diversity in a genomic region computed from allele 
frequencies. 
In general, reduction in diversity is a signal of 
selection, and detecting selection based on the reduction in 
genomic diversity is a subtle task, because 
\begin{enumerate}[(i)]
	\item  in soft sweeps the genomic diversity does not 
	necessarily reduce.
	\item even in hard sweeps with no recombination, the 
	reduction diversity is 
	significant only when the SFS sample is taken close to 
	fixation (not too 
	far prior or after fixation)
	\item SFS change in the same way for both selection an 
	demography changes. 
\end{enumerate}

Although conditions (hard sweep with no recombination, not 
far from 
fixation, and random-mating and constant size population) 
for detecting 
selection based on SFS are very restrictive, SFS-based tests 
are simple and 
inexpensive to use and often used in combination with 
other tests~\cite{akey2009constructing,vitti2013detecting}. 

In practice, (positive and sum-to-one) weighted 
linear combinations scaled SFS distribution \cite{achaz2009frequency}
is used as different estimators of $\theta$ and pairwise discrepancy between 
them is used as a test statistic for detecting selection.
Under neutrality, the discrepancies should be distributed around zero, and a 
simple $t$ test can provide p-value for rejecting neutrality. 
For example, 
test statistics for Tajima's $D$\cite{tajima1989statistical}, 
Fay Wu's $H$~\cite{fay2000hitchhiking} and 
SFSelect\cite{ronen2013learning} can be obtained by a dot 
product of the scaled SFS vector with their corresponding weight vector. 




\paragraph{Dynamic Data (ad-hoc).} On the other hand, tests-of-selection for 
dynamic 
data is less studied, and 
often existing tests for static data are adopted for dynamic data in an ad-hoc 
manner. For example, Zhu et al. \cite{zhou2011experimental} used the ratio of 
the estimated 
population size of case and control populations to compute test statistic for 
each window.
Burke et al.~\cite{burke2010genome} applied 
 Fisher exact test to the last observation of data on case and control 
 populations.
 Bergland et al. \cite{bergland2014genomic} 
 applied $F_{st}$ to populations throughout time to signify their 
 differentiation from ancestral as well as geographically different 
 populations. 
 Jha et al. \cite{jha2015whole} 
 computed test statistic of generalized 
 linear-mixed model (GLMM) directly from read counts. 

\paragraph{Dynamic Data (direct).} To perform statistical test on time-series 
data directly, 
Feder et al. \cite{feder2014Identifying} proposed Frequency Increment
Test(FIT) for dynamic frequency data and Likelihood Ratio Test (LRT) for 
frequency/haplotype dynamic single-population data.
Specifically, FIT is a neutrality test which uses (continuous-time 
continuous-state) Brownian motion process for modeling variation of 
 allele frequencies under genetic drift. 
 Basically, given current allele frequency 
 $\nu_t$ at a site, Brownian motion approximation assumes 
 future-generations allele 
 frequencies are drawn from the Gaussian distribution
 \beq
 \nu_{t+\tau}\sim 
 \Nc\left(\nu_t,\frac{2\nu_t(1-\nu_t)}{N_e}\tau\right) 
 \label{eq:brown}
 \eeq
 In other words, under neutrality, increments of the consecutive observations 
 drawn from a Gaussian with 
 zero mean and variance of \eqref{eq:brown}, and p-value of and be readily 
 computed via a Student's t-test. More recently, Song et al. 
 \cite{Terhorst2015Multi} computed LRT statistic by fitting 
 parameters to a Gaussian process model to the time series frequency data. 


\paragraph{Notation.} Let $\bfX = (X_{ijk}) \in [0, 1]^{T \times 
M\times R}$ denote the population frequency where $T$ is the number of samples 
in time, $M$ is the number of segregating sites, and $R$ is the number of 
replicates. Samples in time are taken such that $\tau_1<\tau_2,\cdots<\tau_T$.
To simplify our notation, we define $x_t$ as a allele frequency of a site in a
 replicate, and we denote it by $\nu_t(s,h)$ if such a site is directly 
 under 
 selection with the strength $s$ and overdominance of $h$. For 
 notation 
 convenience, henceforth we omit dependence of $\nu_t$ to $s$ and 
 $h$. 
 Thus, $\nu_t$ denotes the frequency of 
 the carrier of beneficial allele in the population $t$ generations, since the 
 onset of selection.


\paragraph{Hard and Soft Sweep.}
Selective sweeps are classified by the amount of 
variation exist in the individuals carrying adaptive allele. By definition, 
hard sweep is the case when all the carriers coalesce after onset of selection 
and thus diversity between carriers is at its minimum. 
In general, excess of genetic variation in carriers of adaptive allele, makes 
it difficult to detect selection, i.e., soft sweep is difficult to detect. 
In the following, we conduct and evaluate our simulations for soft and hard 
sweep separately. Since here we do not take into account of de novo mutations, 
soft sweep can only happen in standing variation 
where the site under selection is at frequency is larger than $1/F$. In 
contrast, hard sweep experiments are those that their adaptive allele is at its 
minim frequency, $1/F$, at the onset of selection.


\paragraph{Challenges.}
The main constraint in the adaptive experimental evolution is the 
sampling-time-span (STS), the number of generations 
between the first and last sampled generations. Given a 
fixed amount of time for an study, the longer generation times of the organism, 
the smaller number of generations can be evolved and re-sequenced. 
This implies that, only quite strong selection pressures, STS will be of the 
same order of fixation time. As a result, the time series data usually only 
captures a ``partial sweep".

Moreover, in controlled experimental evolution experiments, populations are
evolved and 
inbred. This scenario in which population 
size 
significantly drops from the large number of wild type (e.g.D. melanogaster 
$N_e\approx10^6$ ) to a small number (typically $F$ is between 100-1000) of 
founder lines for EE, resembles a severe population bottleneck. 
Such a intense reduction in effective population size increases the variance of 
bionomial sampling in the Wright-Fisher model, and consequently makes genetic 
drift quite strong. Also, signal of selection in SFS is absorbed by such a 
strong bottleneck and makes it harder to identify selection.

\section{Results}
\subsection{Tests for detecting selection on time series data.}
\paragraph{FIT performs poorly when $\tau \neq 1$ or $\nu_0$ is not close to 
0.5.}
First we show that Brownian motion provides a poor 
approximation for the distribution of future allele frequencies $\nu_{\tau}$
when the initial frequency $\nu_0$ is not close to $0.5$, or when sampling in 
time is sparse i.e., 
$\tau>1$. 
To test this, we simulated 150K simulations for $\nu_0=0.005$ and 
$\tau\in\{1,10,100\}$ and 100K simulations for $\nu_0=0.1$ and 
$\tau\in\{1,10,100\}$ . As shown in Figure \ref{fig:markov}, Brownian motion 
performs poorly when initial frequency is small or the sampling is sparse.

At the start of selection, $\nu_0$ is at its minimum in hard sweep and is at 
low frequency in the soft sweep with standing variation due to SFS of a neutral 
population(Figure \ref{fig:afs}). Thus if the selecting 
site is chosen randomly 
with high probability its frequency will be far from 0.5 and FIT will be end up 
with high rates of false positives/negatives. 
Moreover, in experimental evolution experiments sampling in time is quite 
sparse e.g. $\tau_i-\tau_{i-1}$ is of the order of 10-100 generations in D 
melanogaster studies.

\paragraph{Markovian Likelihood for Neutral Evolution.}
Here we turn the problem of small population size in EE to our advantage to 
compute likelihood of time series observation exactly using Wright-Fisher 
Markov chain.
Precisely,
(discrete-time discrete-state-space) Wright-Fisher Markov Chain with 
transition matrix $P$ for population of $N$ diploid individuals
\beq
P_{i,j}=\pr\left(\nu_{t+1}=\frac{j}{2N} \left| 
\nu_{t}=\frac{i}{2N}\right)={2N 
	\choose j} \right. 
\nu_{t}^j (1-\nu_{t})^{2N-j}  
\eeq
where $P_{i,j}$ denotes probability of 
changing allele frequency of $\frac{i}{2N}$ to $\frac{j}{2N}$ in one 
generation, due to genetic drift.
Transition probabilities for $\tau$ generations ahead 
can be computed by 
powering the transition matrix to $\tau$.
Figure \ref{fig:markov} illustrates expected and observed distribution of 
frequencies after 
1, 10 and 100 generations when starting frequency is 0.005 (top) and 0.1 
(bottom) using Markov chain provides an accurate distribution of 
allele frequencies 
for future generations, under genetic drift.

\paragraph{Markovian Likelihood for Selection.}
We can also compute the Markov chain for single locus selection (see section 
\ref{sec:comale}), compute the conditional distribution 
$\pr(\nu_{t+1}|\nu_{t},s)$, and maximum likelihood estimate of $s$ accordingly. 
Similar to the null model, we can compute distribution of $t$ generation ahead 
by powering the transition matrix to $t$.
We conducted 100K simulations with selection strength $s=0.1$ on a site with 
frequency $\nu_0=0.005$ and computed empirical and predicted distribution of 
frequencies after 1,10 and 100 generations by Markov chain \eqref{eq:markovs}. 
As shown in Figure \ref{fig:markovs} the distribution of empirical data follows 
that of Markov chain.





\paragraph{SFS based statistics in time series.}
We also considered SFS based tests including Tajima's D, Fay \& Wu's H and 
SFSelect for detecting selection. 
As these tests work only on static data, we extend them for time series data 
for both null and alternative hypotheses.
More precisely, we explicitly defined functionals $D_t$ and $H_t$ as function 
of initial carrier frequency $\nu_0$ and strength of selection $s$ (see section 
\ref{sec:sfs-ts} for details).
 To show that the proposed models of $D_t$ and $H_t$ are valid models, we 
 simulated 1000 populations and computed SFS based statistics every 10 
 generation and compared them with the proposed model.
 As shown in the Figures \ref{fig:dynamic-weak} and \ref{fig:dynamic-strong} 
 (last 
row, left), models are more consistent with data in hard sweep simulations and 
performs poorly in soft sweep experiments, where initial carrier frequency 
$\nu_0=0.1$.


\paragraph{SFS based tests will fail when carrier frequency $\nu_t$ is low.}
Also, by examining the functional form of $D_t$, we will show that even in a 
infinite population size setting, 
differentiating the between selection and drift is difficult in early 
generations of hard sweep. 

As shown in the Figure 
\ref{fig:tdterms} right, in early 
generations of hard sweep where carrier frequency is low, 
$D_t$ is either 
positive or close zero. In other words, the reduction in 
diversity become 
significant when carrier frequency is high enough.
It can be shown that this argument holds for $H_t$ in early generations 
of hard sweep, where carrier frequency is not high.

Finally, we show that SFSelect under selection exhibits a monotonously 
non-decreasing behavior which can be differentiated from genetic drift in hard 
sweep
(Figure \ref{fig:dynamic-weak} and \ref{fig:dynamic-strong} (forth
row))



\subsection{Detecting Selection}
To evaluate detection power of COMALE statistic, we 
compare it with Gaussian process (GP) \cite{Terhorst2015Multi}, FIT 
\cite{feder2014Identifying},  SFselect \cite{ronen2015predicting}, 
$D$\cite{tajima1989statistical}, and $H$ \cite{fay2000hitchhiking} statistics. 
We also take time-series models of $D$ and $H$ into comparison by fitting 
models \eqref{eq:tdt} \eqref{eq:ht} to data. Finally, since SFSelect is 
positive and 
monotone, we considered the aggregation of SFSelect statistics 
along time-series as score for detecting selection.

For every experiment, (with a specific strength of selection, initial carrier 
frequency, 
sampling time span and number of replicates), we conduct 200 simulations of 
which half are neutral and the rest are under selection. We define power of 
each method as average true-positive rate when 
false-positive rate is less than 0.1 over 200 simulations.


\paragraph{Power for default setting.}
First we compare all the methods under default parameter settings, i.e., 
$T=5$, $\tau=50$ and $R=3$. As shown in the Figure \ref{fig:power}, \comale
statistic provides a better detection power in both hard and soft sweep regimes 
for all values of selection strength. 
Also, except for $H$ in strong selections, SFS-based scores exhibit poor 
performance, comparable to random prediction. 
Also, GP and FIT, which are single-locus methods, reveal 
their best performance in softest sweep, $\nu_0=0.1$.

\paragraph{Power of \comale for different STS.}
Also, we assessed the behavior of \comale for different values of STS
$\tau\in\{10,50,100\}$. For the default set of parameters, and $\tau=100$, 
\comale method provides significantly better performance, while for $\tau=10$ 
detection 
power is comparable to those of other methods for $\tau=50$ in Figure 
\ref{fig:power}. 

\paragraph{Power of \comale for different number of replicates.}
Effects of number of replicates on the power of \comale method is 
examined for $R\in\{3,5,10\}$, Figure \ref{fig:powerr}. Interestingly, 
increasing number of replicates does not necessarily improve power, yet they 
provide comparable power to the case with $R=3$. This observation implies that 
estimates of power for each method tightly depend on the replicates used for 
evaluation, and computed power of a method potentially under/over-estimated due 
to finite sample size, i.e. \emph{estimation error}. Thus, comparison using 
small number of replicate is meaningful only when difference in performance is 
significant and consistent for different configuration, which is the case for 
LS method in Figure \ref{fig:power}. 

\paragraph{Trade off between STS and number of replicates.}
Finally, Figure \ref{fig:powerrt}, 
demonstrates the power for $R=\{3,10\}$ and $\tau={50,100}$, which shows power 
for $R=3$ and $R=10$ exhibits the similar behavior under different regimes fo 
$\nu_0$, $s$ and $\tau$.

\subsection{Locating the Adaptive Mutation}
The secondary task in identifying selection is to locate the position of the 
adaptive allele. We simply consider the site with highest score in the window 
as the locus of the beneficial allele. 

For each setting of $\nu_0$ and $s$, we conducted 100 
simulations and computed the rank of the beneficial mutation in the sorted 
scores. Then for each configuration, Cumulative Distribution Function (CDF) of 
the distribution, of rank of the adaptive allele for 100 
simulations is plotted in Figure \ref{fig:rank}. 

\comale works the best in hard sweep regime. For example, 
when $\nu_0=0.005$ and $s=0.01$ (weakest selection), the beneficial allele is 
ranked first, in more than 60 experiments, and take rank of less than 5 in more 
than 90\% of experiments of hard sweep. Accuracy of the locating the adaptive 
allele diminished as sweep become softer, i.e. larger values of $\nu_0$. Yet, 
in the worst case the beneficial allele is tanked among top 50 SNPs.

\subsection{Strength of  Selection}
Finally, estimating the model parameters such as strength of selection provides 
the finest detail of identification of a selective sweep process, since given 
the model parameters we can predict the state of population, e.g. fixation 
time, in future generations. 

To estimate $s$, likelihood of data is computed via Wright-Fisher Markov chain 
\eqref{eq:markovs}, and maximum likelihood $\hat{s}$ is readily computed.
We computed bias, $s-\hat{s}$ for each 
experiment of \comale, and GP. The distribution of the bias is presented in 
Figure 
\ref{fig:bias} for different configurations. In general, both GP and  \comale 
are 
biased for weak selections, which genetic drift dominates. However, for 
stronger sweeps, e.g.$s=0.1$, \comale provides estimates with smaller bias and 
variance.

\subsection{Analysis of Real Data}
We finally apply \comale method to the controlled experimental evolution 
experiment 
of \cite{orozco2012adaptation}, which evolves 5 replicates of a population of 
Drosophila melanogaster for 37 generations under alternating 12-hour cycles of 
hot (28$^{\circ}$C) and cold (18$^{\circ}$C) temperatures. Three replicates are 
sampled at the firs generation, 2 replicates at generation 15, one replicate at 
generation 23, one replicate at generation 27 and three replicates at 
generation 37.

Figure \ref{app:af} demonstrates Manhattan plot for the scan of data. Genes 
will be extracted ASAP.

\section{Materials and Methods}
\subsection{Simulations}
For each experiment a diploid population is created and evolved as 
follows. 
\begin{enumerate}[I.]
	\item {\bf Creating initial founder line haplotypes}
	First using msms program, we created neutral populations for $F$ 
	founding 
	haplotypes with \emph{default} parameters \texttt{\$./msms <F> 1 
	-t 
		<2$\mu$LNe> 
		-r <2rNeL> 
		<L>} 
	where $F=200$ is number of founder lines, $N_e=10^6$ is 
	effective 
	population size, $r=2*10^{-8}$ is recombination rate and 
	$\mu=2\times 
	10^{-9}$ is mutation rate and  $L=50K$ is the window size in 
	base pairs 
	which gives $\theta=2\mu N_eL=200$ and $\rho=2N_erL=2000$. 
	For 
	default 
	parameter, the expected number of segregating sites in a window 
	is 
	\beqq
	\Ebb[M]=\theta \sum_{i=1}^{F-1}\frac{1}{i}=1175
	\eeqq
	\item{\bf Creating initial diploid population} 
	To implement similar setting for experimental evolution of diploid 
	organisms, 
	initial  haplotypes first cloned to create $F$ diploid homozygotes. 
	Then 
	each 
	diploid individual is  cloned $N/F$ times to yield diploid 
	population of 
	size 
	$N$.
	\item{\bf Forward Simulation}
	Given initial diploid population, position of the site under 
	selection, 
	selection 
	strength $s$, number of replicates $R=3$, recombination rate 
	$r=2\times10^{-8}$ 
	and sampling times $\Tc=\{10,20,30,40,50\}$, \texttt{simuPop} is 
	used to 
	perform
	forward simulation and  compute allele frequencies for all of the 
	$R$ 
	replicates. Also, to avoid spurious simulation samples, simulation 
	results 
	are constrained to those that the beneficial allele escapes 
	stochastic loss 
	of genetic drift and \emph{establishes} in all the replicates. 
\end{enumerate}

\subsection{Least-Squares Estimate of $s$} 
\label{sec:regression}
In a simplest case, we have 2 observations, $\nu_0$ and $\nu_t$ and we wish to 
find 
$\hat{s}$ so that $\nu_t=\sigma(\hat{s}t/2+\eta(\nu_0))$ which can be solved 
analytically:
\begin{equation}
\hat{s}=\frac{2}{t} \log \left( \frac{\nu_t(1-\nu_0)}{\nu_0 (1-\nu_t)} \right) 
= 
\frac{2}{t}  \left( \eta(\nu_t)-\eta(\nu_0)\right)
\label{eq:naive2point}
\end{equation}
which selection strength can be interpreted as the normalized frequency 
increment in log-odds space.

However, with more than two observations, the system become over determined and 
we need to solve $T$ set of equations, where $T$ is the number of samples in 
time ($\bfX\in[0,1]^{T\times R \times M}$). By re-arranging 
\eqref{eq:naive2point}, we can write a set of linear equations

\beq
t s&=2(\eta(\nu_t)-\eta(\nu_0)) \ \ \ \ \ \forall t \in \Tc \\ 
\eeq
which can be written in matrix form $\bft s =\bfb$ with
\beq
\bft=\begin{bmatrix}
	\tau_1\\
	\vdots \\
	\tau_T
\end{bmatrix}
\bfb=\begin{bmatrix}
 2(\eta(\nu_{\tau_1})-\eta(\nu_0))\\
	\vdots \\
2\eta(\nu_{\tau_T})-\eta(\nu_0))
\end{bmatrix}, \ \ \ \ \ 
\eeq
and the solution for each replicate can be computed using pseudo inverse

\beq
\hat{s}_r=\bft^+\bfb=(\bft^T\bft)^{-1}\bft^T\bfb=\frac{\bft^T\bfb}{\|\bft\|^2}
\eeq
and for multiple independent replicates with the same sampling times we have
\beq
\hat{s}= \frac{1}{R} \sum_r^R \hat{s}_r = \bft^+\bar{\bfb}
\eeq
where $\bar{\bfb}$ is the average of $\bfb$ over $R$ replicates.
Finally, for each replicate, instead of $T$ equations where each observation is 
compared with $x_0$, we can take all possible pairs and solve ${T \choose 2}$ 
set of equations.
\subsection{\comale Test}\label{sec:comale}

Given an estimate for $s$, the Markov chain with transition 
probabilities 
(\cite{Ewens2012Mathematical}, eq 1.58-59)
\beq
Q_{i,j}(s)&=\pr\left(\nu_{t+1}=\frac{j}{2N} \left| 
\nu_{t}=\frac{i}{2N}\right)={2N 
	\choose j} \right. 
\hat{\nu}_{t+1}^{j} (1-\hat{\nu}_{t+1})^{2N-j},\\
\hat{\nu}_{t+1}&=\sigma(\hat{s}+\eta(\nu_t))\label{eq:markovs}
\eeq
computes probabilities of time-series under the alternative 
model. Figure \ref{fig:markovs} shows that the predicted distributions of 
frequencies using Markov chain \ref{eq:markovs} is consistent with simulation 
data.

Likelihood of the trajectories under null and alternative 
hypothesis can be 
computed to perform likelihood ratio tests which provide 
predictors that are 
robust to pathological false-positives 
\cite{feder2014Identifying}. 
Specifically, for each site, we define the likelihood-ratio 
predictor
\beq \label{eq:lrt}
\Lambda(\hat{s}) = \hat{s}\log 
\left(\frac{\Lc(\bfx|s=\hat{s})}{\Lc(\bfx|s=0)}\right)
\eeq
where $\bfx$ is the vector of trajectories and $\Lc$ is the 
likelihood function 
defined by the Markov chain with transition 
\eqref{eq:markovs}.

Given likelihood ratio \eqref{eq:lrt} for each SNP we can further exclude false 
positives by combining likelihood ratio scores of the polymorphisms in a 
genomic region by computing Composite 
Likelihood 
Ratio(CLR)\cite{nielsen2005genomic,williamson2007localizing,vitti2013detecting}.
For each window, CLR is computed by taking average of top one percentile of the 
likelihood ratios.

\subsection{SFS based test on time series data}\label{sec:sfs-ts}
To adapt SFS-based test for dynamic data, one can simply design statistical 
tests to examine whether the 
observations of $D$, $H$ and SFSelect statistics are 
significantly deviated 
from the null distribution, i.e. constant values in time.
On the other hand, we can model the dynamics of SFS as a 
function of selection 
strength to 1)have a model for estimating model parameter 2)obtain an insight 
regarding how does SFS statistics behave under different 
stages of selection.

As mentioned before, restricting population to $F$ founder lines ($F<<N_e$) 
resembles a severe bottleneck event, which confound SFS. Figure 
\ref{fig:bottleneck} demonstrates effect of controlled experimental evolution 
on different SFS statistics under neutral evolution for 1000 simulations. The 
mean of 
neutral simulations can be used to empirically filter out the effect of 
bottleneck in dynamic data. 

\begin{enumerate}[I.]
	\item {\bf Tajima's D}. As shown in the Appendix \ref{app:td}, dynamic of 
	Tajima's D in hard sweep is
	\beq
	D_t=D_0-\log(1-\nu_t) \frac{W_0}{\log(2N)} -\nu_t^2 \Pi_0\label{eq:tdt}
	\eeq
	
	where $W_0$ and $\Pi_0$ are Watterson and Tajima estimate 
	of $\theta$ at 
	the first generation.
	Given that $\nu_t$ defined in term of $\nu_0$ and $s$ in 
	\eqref{eq:nut}, we 
	can use \eqref{eq:tdt} to estimate the strength of 
	selection by performing a nonlinear 
	regression to find 
	$s$. Then, a likelihood ratio, similar to \eqref{eq:lrt}, 
	provides\footnote{The 
		likelihood of the data to the model is the least-squares 
		loss between model 
		$D_t(\hat{(s)})$ and the observed $D$.} a predictor for 
	detecting selection in each window. 
	
	
	
	\item {\bf Fay Wu's H} As shown in the Appendix \ref{app:h}, dynamic $H$ 
	statistic is directly related to average of Haplotype Allele Frequency 
	(HAF) \cite{ronen2015predicting} and 
	can be written
	\beq
	nH_t= \theta \nu_t \left(\frac{\nu_t+1}{2} - \frac{1}{(1-\nu_t)n+1}\right) +
	\theta (1-\nu_t)\left(\frac{n+1}{2n}-\frac{1}{(1-\nu_t)n+1}\right) 
	\label{eq:ht}
	\eeq
	which is a good approximation only in hard sweep with strong selection, 
	Figures 
	\ref{fig:dynamic-weak} and \ref{fig:dynamic-strong} (second
	row, left). 
	

	
	\item {\bf SFSelect} statistic proposed by Ronen et 
	al. \cite{ronen2013learning} to predict selection by empirically learning 
	the so-called \emph{optimal} weights using Support Vector Machines. 
\end{enumerate}

Whether the dynamic of SFS in times-series can improve the detection power in 
the conditions (i-iii) is not well-studied yet. Evans et al. 
\cite{evans2007non} developed diffusion equations for 
evolution of SFS in time series, they are difficult to solve. 
Hence, we analyze and visualize scalar test statistics $D$, $H$ and SFSelect 
in the dynamic data under different selection regimes.


\section{Discussion}


\section{Appendix}
\subsection{Allele frequencies under selective sweep} \label{app:af}
Let in a dialellic diploid Wright-Fisher model with single locus selection, 
with genotypes 0|0, 0|1 and 1|1 , $w_{00}$, $w_{01}$ and  $w_{11}$ be the 
relative fitness of each genotype at a locus. Also, consider $x$ to be 
frequency of the allele 1 and allele 1 be the favored allele, then
\beq
&w_{00}=1,&w_{01}=1+us,&w_{11}=1+s
\eeq
\beq
x_{t+1}&=\frac{w_{11}x_t^2 + w_{01}x(1-x_t)}{w_{11}x^2_t + 2w_{01}x_t(1-x_t) + 
w_{00}(1-x_t)^2} =x_t+\frac{s(h+(1-2u)x_t)x_t(1-x_t)}{1+sx_t(2u+(1-2u)x_t))} 
\eeq
where $s\in \Rbb$ is the selection coefficient and $o\in[0,1]$ is the 
overdominance parameter which for $u=0.5$ we have
\begin{equation}
x_{t+1}=x_t+\frac{sx_t(1-x_t)}{2+2sx_t}\;.
\label{eq:transition}
\end{equation}
we also have
\beq
\frac{\bfd x_t}{\bfd t} = \frac{sx_t(1-x_t)}{2+2sx_t}
\eeq
which is a differential equation that is difficult to solve. However if take 
the approximation $2+2sx_t \approx 2$, it becomes an ordinary differential 
equation that can be readily solved

\begin{equation}
\nu_t =\frac{1}{1+\frac{1-x_0}{x_0}e^{-st/2}} = \sigma(st/2+\eta(x_0)) 
\label{eq:inf-pop}
\end{equation}
where$\sigma(.)$ is the logistic
function and $\eta(.)$ is logit function (inverse of the logistic function). 

\subsection{Logistic Model for Selection.}
As maximum likelihood for estimating $s$ using Markov chain is computationally 
expensive, here we use and logistic function for modeling allele frequencies 
undergoing selective sweep.
In a pure selection process with no drift, i.e. infinite 
population size, 
dynamic of allele frequencies 
can be well approximated by the logistic function (see 
Appendix \ref{app:af} 
for 
derivation)
\beq
\nu_t=\sigma(st+\eta(\nu_0))\label{eq:nut}
\eeq
where $\sigma(x)=1/(1+e^{-x})$ is the logistic function, and 
$\eta(x)=\log(x)/\log(1-x)$ is inverse of the 
logistic, aka logit, function. Figure \ref{fig:sweep} depicts 
the behavior of 
the logistic model for site allele frequencies and the 
default sampling time 
span(STS). Without genetic drift, soft sweep is easier to 
detect, 
because the logistic function happens to have steeper slope 
in th STS than 
those of hard sweeps, due to standing variation frequency. In addition, even 
under infinite 
population size regime, it is 
difficult differentiate between weak selections and genetic 
drift (a horizontal 
line), in short (e.g. 50 generations) experimental evolutions.


As shown in Figures \ref{fig:dynamic-weak} and \ref{fig:dynamic-strong} (first 
row), the approximate logistic model is consistent with 
simulated data and we 
use it to estimate the strength of selection for 
each site by solving a linear system of equations(see Section 
\ref{sec:regression} for details).

\subsection{Fay Wu's H}\label{app:h}
\bl
In any finite population size of $n$ with $m$ segregating sites, 
allele frequencies take 
discrete values, i.e.,  $x_j \in 
\{\frac{1}{n},\frac{2}{n},\ldots,\frac{n-1}{n}\}, \ \forall j \in{1,\cdot,m}$ 
and we can write
\beq
\|\bfx\|^2= \sum_{j=1}^{m} x_j^2 = 
\sum_{i=1}^{n-1}\left(\frac{i}{n}\right)^2\xi_i= 
\frac{ (n-1)}{2n}H 
\eeq
where $\xi_i$ is the number of sites with frequency $i/n$ and $H$ is the 
Fay \& Wu's estimate of $\theta$.
\el

Recently, Ronen et al. ~\cite{ronen2015predicting} devised the $1\dHAF$ 
statistic for identifying selection on static data, which has the expected 
value related to the $\|\bfx\|^2$:
\begin{equation} 
\Ebb[1\dHAF(t)]= n\| \bfx_t\|^2\approx ng(\nu_t)
\end{equation} 
where
\beq
g(\nu_t)= \theta \nu_t \left(\frac{\nu_t+1}{2} - \frac{1}{(1-\nu_t)n+1}\right) +
\theta (1-\nu_t)\left(\frac{n+1}{2n}-\frac{1}{(1-\nu_t)n+1}\right)
\label{eq:hafscorepooled}
\eeq
where easily follows that
\beq
\theta_H(t)=\frac{n-1}{2} g(\nu_t)
\eeq

\subsection{Tajima's D}\label{app:td}
Let $D_0, \Pi_0, W_0$, be Tajima's D, Tajima's estimate of  $\theta$, and 
Watterson's estimate of $\theta$ at time zero and $D_0=\Pi_0 - W_0$.
In order to compute, $D_t=\Pi_t - W_t$ we compute $\Pi_t$ and $W_t$ separately 
as follows.

Let $P$ be the $n \times n$ matrix of pairwise heterozygosity if individuals, 
then $\Pi=\frac{1}{n^2}\sum P_{ij}$. So, if the population consist of $\nu n$ 
identical carrier haplotype (due to lack of recombination), their pairwise 
hamming distance is zero and should be subtracted from the total $\Pi_t$:
\beq
\Pi_t&= (1-\nu_t^2)\Pi_0 
\eeq

To compute $W_t$, first remember that $W_t= \frac{m_t}{S_n}$ where $m_t$ is the 
number of segregating sites at time $t$ and $S_n= \sum_i^n 1/i \approx 
\log(n)$. Also we have
\beq
\frac{W_t}{W_0}&=\frac{\frac{m_t}{S}}{\frac{m_0}{S}} \ \ \Rightarrow 
W_t=\frac{m_t}{m_0}W0 
\eeq
where $m_t$ to be interpreted as the expected number of segregating sites at 
time $t$, under neutral evolution. At time $t$, the number of individuals that 
undergone neutral evolution is $(1-\nu_t)n +1$, which leads to
\beq
\frac{m_t}{m_0}&=\frac{\log\left((1-\nu_t)n +1 \right)\theta}{\log(n)\theta} 
\approx  
\frac{\log\left((1-\nu_t)n\right)}{\log(n)} = \frac{\log(1-\nu_t)+\log(n)}{\log(n)} = 
1+ \frac{ \log(1-\nu_t)}{\log(n)} 
\eeq
putting all together 
\beq
D_t&= (1-\nu_t^2)\Pi_0 - (1+ \frac{ \log(1-\nu_t)}{\log(n)} ) W_0 = 
D_0-\log(1-\nu_t) \frac{W_0}{\log(n)} -\nu_t^2 \Pi_0
\eeq


\subsection{Linkage Disequilibrium}
Nonrandom associations between polymorphisms are established in the 
substitution process according to the phylogeny, broken by recombination events 
and reinforced by selection. Although in EE the experiments with pooled 
sequencing, LD can not be measured throughout evolution, it is still worthwhile 
to examine the behavior of LD as a result of the interaction between 
recombination and natural selection, to take into account of some of EE 
implicit constraints. 

Let $\rho_0$ be the LD at time zero between the site under selection and a 
segregating site $l$ base-pairs away, then under natural selection we have
\beq
\rho_t= \alpha_t\beta_t \rho_0=e^{-rtl} \left(\frac{H_t}{H0}\right)  
\rho_0\label{eq:ldt}
\eeq
where $H_T=2\nu_0(1-\nu_0)$ is the heterozygousity at the selected site, $r$ is 
the recombination rate/bp/gen. The decay factor $\alpha_t=e^{-rtl}$ is the 
product of recombination and growth factor $\beta_t$ (eq. 30-31 in 
\cite{Stephan2006The})is the outcome of 
selection. For $s=0.01$, $l=100K$bp, the log of decay, growth and product of 
both is depicted in Figure \ref{fig:ldf}. It is evident that, for these 
parameters LD does not start to decay until generation 1000, which would be  
problematic when $\rho_0$. For example, in the case of hard sweep, the 
selection is imposed on the site with minimum AF, which is at perfect linkage 
($|D'|=1$) with all the other loci.\footnote{This is because, between the 
	selected site and all the other sites frequency of one gamete is zero.}
We this phenomenon is shown in the Figures \ref{fig:ld2d}, \ref{fig:ld3d} where 
at generation zero the site at position 500K is at perfect linkage with all the 
other sites, and linkage of the middle site with all the genome is depicted 
for both genetic drift and natural selection, in different generations.
Also, a window of 50Kbp around the selected site is shaded in Figure 
\ref{fig:ld2d} to demonstrate the value of LD in the window under drift and 
hard sweep. This implies that the precision of locating the selection on the 
genome is tightly dependent on a set of parameters including, recombination 
rate, selection strength, initial carrier frequency, and the initial linkage.



\section{Figures}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.2]{afs}
	\caption{SFS}	\label{fig:afs}
\end{figure}

\begin{figure}[H]
	\begin{tabular}{lr}
		\centering
		\includegraphics[trim={2in 0.1in 1.5in 
			0in},clip,page=2,width=0.5\textwidth]{sigmoidSoft}
		&\includegraphics[trim={2in 0.1in 1.9in 
			0in},clip,page=2,width=0.5\textwidth]{sigmoidHard}
	\end{tabular}
	\caption{Logistic model for different selection strengths 
		for soft (left) 
		and hard (right) sweep as a function of time in 
		generations. The first 
		50 
		generations, which observations are sampled is 
		shaded.} 	 
	\label{fig:sweep}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[trim={0in 0.1in 0in 
		0in},clip,width=\textwidth]{{markov0.005}.png}\\
	\includegraphics[trim={0in 0.1in 0in 
		0in},clip,width=\textwidth]{{markov0.1}.png}
	\caption{Predicted distributions of allele frequencies of 
		sites with 
		initial frequency $\nu_0=0.005$ (top) and $\nu_0=0.1$ 
		(bottom), after 
		$t=\{1,10,100\}$ generations, under neutral evolution, by 
		Brownian mothion 
		and Markov chain. Observed distribution of 143900 sites 
		with $\nu_0=0.005$ 
		and 47500 with variants $\nu_0=0.1$ computed from 
		neutrally evolving 
		simulations is depicted in green lines.} 	 
	\label{fig:markov}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[trim={0in 0.1in 0in 
		0in},clip,width=\textwidth]{{markov.s0.1}.png}
	\caption{Predicted distributions of allele frequencies of 
		sites with 
		initial frequency $\nu_0=0.005$ and selection 
		strength $s=0.1$, after 
		$t=\{1,10,100\}$ generations,by Markov chain. 
		Observed distribution of the adaptive allele 
		(with$\nu_0=0.005$) in 
		10000 simulation is shown in green.} 	 
	\label{fig:markovs}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[trim={0in 0.1in 0in 
		0in},clip,width=\textwidth]{{tdterms}.png}
	\caption{Interactions of two terms in $D$. W.l.o.g when $D_0=0$ and 
	$\Pi_0=W_0=1$, 
		$D_t$ is sum of the 
		logarithmic $\frac{-\log(1-\nu_t)}{\log(2N)}$ and the squared term 
		$\nu_t^2$.} 	 
	\label{fig:tdterms}
\end{figure}

\begin{figure}[H]
	\centering 
	\includegraphics[trim=3.2in 0.1in 3.2in 0.2in , 
	clip,width=\textwidth]{bottleneck}
	\caption{Effect of bottle neck in a typical experimental evoloution 
		experiment where a restricted number of founder lines (here $F=200$) is 
		selected out of a larger population size ($N_e=10^{-6}$). Tajima's D 
		(left), Fay Wu's H (middle) and SFSelect is computed for 1000 neutral 
		simulations and mean and 95\% confidence interval is plotted.} 
	\label{fig:bottleneck}
\end{figure}

\begin{figure}[H]
	\centering 
	\includegraphics[trim={2in 0.5in 2in 
		0in},clip,page=1,width=\textwidth]{{GlobalDynamics.TimeSeries}.pdf}
	\caption{Mean and 95\% CI of 1000 simulations for strong selection.}
	\label{fig:dynamic-strong}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[trim={2in 0.5in 2in 
		0in},clip,page=4,width=\textwidth]{{GlobalDynamics.TimeSeries}.pdf}
	\caption{Mean and 95\% CI of 1000 simulations for weak selection.}
	\label{fig:dynamic-weak}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{decayFactors}
	\caption{Interaction between productive factors of LD under natural 
		selection for weak selection (s=$0.01$) and a distance of 100Kb between 
		sites. In this setting, after about 1000 generations LD start to decay 
		(red 
		curve).} \label{fig:ldf}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{LDDecay2d}
	\caption{Decay of LD ($|D'|$ measure) of the minimum AF site at position 
		500K with the rest of genome when $s=0.01$ and $r=2\times10^{-8}$. A 
		window 
		of 50Kb is shaded at the center of genome to illustrate high values of 
		linkage in both selection and drift.} \label{fig:ld2d}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{LDDecay3dNeutral}
	\includegraphics[width=\textwidth]{LDDecay3dSweep}
	\caption{ld} \label{fig:ld3d}
	\caption{Decay of LD ($|D'|$ measure) of the minimum AF site at 
		position 500K with the rest of genome in genetic drift with 
		$r=2\times10^{-8}$ (top) and hard sweep with $s=0.01$ (bottom).}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[trim=2.2in 0 2.2in 0 , clip,width=\textwidth]{power}
	\caption{Predictive performance of different method is evaluated on 200 
		simulations for different values of selection strength $s$ and initial 
		carrier frequency $\nu_0$.} \label{fig:power}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[trim=2.2in 0 2.2in 0 , clip,width=\textwidth]{powerTime}
	\caption{Predictive performance of the proposed method is evaluated 
		on 200 simulations for different values of sampling-time-span 
		$\tau$ and initial carrier frequency $\nu_0$.} \label{fig:powert}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[trim=2.2in 0 2.2in 0, 
	clip,width=\textwidth]{powerReplicate}
	\caption{Predictive performance of the proposed method is evaluated on 200 
		simulations for different number of replicates $R$ and initial carrier 
		frequency $\nu_0$.} \label{fig:powerr}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[trim=2.2in 0 2.2in 0, 
	clip,width=\textwidth]{powerReplicateTime}
	\caption{Predictive performance of the proposed method is evaluated on 200 
		simulations for different number of replicates $R$, 
		sampling-time-span $\tau$ and initial carrier 
		frequency $\nu_0$.} \label{fig:powerrt}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[trim=2.2in 0 2.2in 0, 
	clip,width=\textwidth]{bias}
	\caption{Comparison between the distribution of bias of the proposed method 
		with Gaussian Process (GP), over 100 simulations for different values 
		of 
		selection strength $s$ and soft-sweep with $\nu_0=0.1$.} 
		\label{fig:bias}
\end{figure}



\begin{figure}[H]
	\centering
	\includegraphics[trim=.2in 0 .2in 0, 
	clip,width=\textwidth]{rank}
	\caption{CDF of the rank of the adaptive allele in 100 simulations.} 
	\label{fig:rank}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[trim=.2in 0 .2in 0, 
	clip,width=\textwidth]{{snpManhattan}.png}
	\caption{Manhattan plots shows the distribution of candidate (top 2000) 
	SNPs for BM, BF and COMALE (rows 1,2 and 3) and candidate (top 1 \%) 
	regions of COMALE
	size 50Kb and sliding window of 10Kb.} 
	\label{fig:real}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[trim=.2in 0 .2in 0, 
	clip,width=\textwidth]{{snpManhattanOutliers}.png}
	\caption{Manhattan plot of scan for selection using CLR on windows of 
		size 50Kb and sliding window of 10Kb.} 
	\label{fig:realoutlier}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[trim=.2in 0 .2in 0, 
	clip,width=\textwidth]{{snpDensity}.png}
	\caption{Manhattan plot of scan for selection using CLR on windows of 
		size 50Kb and sliding window of 10Kb.} 
	\label{fig:density}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[trim=.2in 0 .2in 0, 
	clip,width=\textwidth]{{hapsManhattan}.png}
	\caption{Manhattan plot of scan for selection using CLR on windows of 
		size 50Kb and sliding window of 10Kb.} 
	\label{fig:density}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[trim=1.2in 0 .0in 0, 
	clip,width=\textwidth]{{dominance}.png}
	\caption{Dominance for $s=0.1$.} 
	\label{fig:dominance}
\end{figure}

%\input{intro}
%\input{method}
%\input{experiment}
%\input{conclusion}
\newpage
\bibliographystyle{acm}
\bibliography{library}
\end{document}
